<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Scheduled ‚Äî Calendar</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:24px}
    .btn{display:inline-block;padding:10px 14px;border:1px solid #ddd;border-radius:12px;text-decoration:none}
    .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .card{border:1px solid #eee;border-radius:16px;padding:14px 16px;margin:10px 0;box-shadow:0 1px 3px rgba(0,0,0,.04)}
    .title{font-weight:600}
    .meta{font-size:14px;opacity:.85;margin-top:6px}
    .empty{opacity:.7}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .pill{font-size:12px;border:1px solid #eee;border-radius:999px;padding:4px 8px}
    .error{background:#fff3f3;border:1px solid #ffd6d6;color:#b00020;padding:12px 14px;border-radius:12px;margin:12px 0}
  </style>
</head>
<body>
  <div class="header">
    <h1>Scheduled ‚Äî Upcoming (14 days)</h1>
    {% if signed_in %}
      <a href="/logout" class="btn">Sign out</a>
    {% else %}
      <a href="/login" class="btn">Sign in with Google</a>
    {% endif %}
  </div>

  {% if error %}
    <div class="error">
      {{ error }}
      {% if session.last_error %}
        <div style="opacity:.7;font-size:12px;margin-top:6px;">Details: {{ session.last_error }}</div>
      {% endif %}
    </div>
  {% endif %}

  {% if not signed_in %}
    <p class="empty">Connect Google Calendar to load events.</p>
  {% else %}
    {% if events|length == 0 and not error %}
      <p class="empty">No upcoming events found.</p>
    {% endif %}
    {% for e in events %}
      <div class="card">
        <div class="title">{{ e.summary }}</div>
        <div class="meta">
          <div class="row">
            <span class="pill">Start: {{ e.start }}</span>
            {% if e.end %}<span class="pill">End: {{ e.end }}</span>{% endif %}
            {% if e.location %}<span class="pill">üìç {{ e.location }}</span>{% endif %}
            {% if e.status %}<span class="pill">{{ e.status }}</span>{% endif %}
            {% if e.htmlLink %}<a class="pill" href="{{ e.htmlLink }}" target="_blank" rel="noopener">Open in Google</a>{% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  {% endif %}
</body>
</html>